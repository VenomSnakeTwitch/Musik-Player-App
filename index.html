<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CODEC // VenomSnake_Twitch</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#050805">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CODEC">
    
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/VenomSnakeTwitch/VenomSnake_Twitch-Webseite/main/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --mgs-green: #00ff41; 
            --mgs-green-dim: #003b00;
            --mgs-bg: #050805;
            --mgs-panel: #0a0f0a;
            --mgs-border: #1a2e1a;
            --text-primary: #d1ffd1;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; cursor: crosshair; }

        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--mgs-bg);
            background-image: linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px), 
                              linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        body::before {
            content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.02), rgba(0, 255, 0, 0.01), rgba(0, 255, 0, 0.02));
            z-index: 9999; background-size: 100% 3px, 3px 100%; pointer-events: none;
        }

        .nav {
            position: fixed; top: 0; width: 100%; height: 70px;
            background: rgba(10, 15, 10, 0.95); border-bottom: 2px solid var(--mgs-green); z-index: 1000;
        }
        .nav-container { max-width: 1200px; margin: 0 auto; height: 100%; padding: 0 2rem; display: flex; justify-content: space-between; align-items: center; }
        
        .nav-controls { display: flex; gap: 10px; }

        .logo { display: flex; align-items: center; gap: 1rem; text-decoration: none; color: var(--mgs-green); font-family: 'Chakra Petch'; font-weight: bold; }
        .logo img { height: 45px; filter: drop-shadow(0 0 5px var(--mgs-green)); }

        .main-container { max-width: 1000px; margin: 100px auto 50px; padding: 0 20px; text-align: center; }
        
        .player-box {
            background: rgba(10, 15, 10, 0.85); border: 2px solid var(--mgs-green); padding: 2rem;
            position: relative; box-shadow: inset 0 0 30px rgba(0, 255, 65, 0.1); width: 100%;
            backdrop-filter: blur(5px);
        }

        h1 { font-family: 'Chakra Petch'; text-transform: uppercase; letter-spacing: 5px; color: var(--mgs-green); margin-bottom: 5px; font-size: 2rem; }
        
        .suno-notice {
            background: rgba(0, 255, 65, 0.1); border: 1px solid var(--mgs-green); padding: 12px;
            margin-bottom: 20px; font-size: 0.8rem; color: var(--mgs-green); text-transform: uppercase;
            line-height: 1.4;
        }

        #currentSong { color: #fff; font-size: 0.9rem; margin-bottom: 20px; background: var(--mgs-green-dim); padding: 12px; border: 1px dashed var(--mgs-green); min-height: 45px; display: flex; align-items: center; justify-content: center; }

        .control-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-bottom: 20px; }
        
        select, button, .download-btn, .home-btn {
            background: transparent; border: 1px solid var(--mgs-green); color: var(--mgs-green);
            padding: 10px; font-family: 'JetBrains Mono'; text-transform: uppercase; cursor: pointer;
            font-size: 0.75rem; transition: 0.2s; text-decoration: none; text-align: center;
        }
        button:hover, select:hover, .download-btn:hover, .home-btn:hover { background: var(--mgs-green); color: #000; box-shadow: 0 0 10px var(--mgs-green); }
        
        .active-mode { background: var(--mgs-green) !important; color: #000 !important; }

        .slider-row { display: flex; align-items: center; gap: 15px; margin: 10px 0; background: rgba(0,255,65,0.05); padding: 10px; border: 1px solid var(--mgs-border); }
        .slider-label { font-size: 0.7rem; color: var(--mgs-green); min-width: 40px; font-weight: bold; }

        input[type="range"] { flex-grow: 1; accent-color: var(--mgs-green); cursor: pointer; height: 6px; background: var(--mgs-green-dim); border: none; }

        #infoBox {
            margin-top: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; text-align: left;
            border-top: 2px solid var(--mgs-border); padding-top: 20px;
        }
        .infoColumn h3 { font-family: 'Chakra Petch'; color: var(--mgs-green); font-size: 0.9rem; margin-bottom: 12px; border-left: 3px solid var(--mgs-green); padding-left: 10px; text-transform: uppercase; }
        .infoColumn p { font-size: 0.75rem; margin-bottom: 6px; color: var(--text-primary); border-bottom: 1px solid rgba(0,255,65,0.05); padding-bottom: 2px; }

        #visualizerOverlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        #visualizerOverlay.active { display: flex; }
        #visualizerCanvas { border: 2px solid var(--mgs-green); max-width: 95vw; max-height: 60vh; background: transparent; }
        
        .vis-player-ui {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid var(--mgs-green);
            background: rgba(0, 255, 65, 0.05);
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 90%;
            max-width: 800px;
        }

        .vis-row { display: flex; gap: 10px; justify-content: center; align-items: center; flex-wrap: wrap; }

        footer { text-align: center; padding: 40px; color: var(--mgs-green-dim); font-size: 0.65rem; letter-spacing: 2px; }

        @media (max-width: 768px) { #infoBox { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<nav class="nav">
    <div class="nav-container">
        <a href="index.html" class="logo">
            <img src="https://raw.githubusercontent.com/VenomSnakeTwitch/VenomSnake_Twitch-Webseite/main/DogVenomsnakeLogo.png" alt="Logo">
            <span>VENOM_SNAKE_AUDIO</span>
        </a>
        <div class="nav-controls">
            <a href="index.html" class="home-btn" style="padding: 5px 15px;">[ STARTSEITE ]</a>
            <button onclick="toggleFullscreen()" style="padding: 5px 15px;">[ VOLLBILD ]</button>
        </div>
    </div>
</nav>

<main class="main-container">
    <div class="player-box">
        <h1>CODEC INTERFACE</h1>
        <div class="suno-notice">
            [ STATUS: TRANSMISSION ACTIVE ]<br>
            Hier werden alle Songs hochgeladen, die ich auf <strong>Suno.com</strong> erstelle.
        </div>

        <h2 id="currentSong">INITIALISIERE...</h2>
        <audio id="audioPlayer" crossOrigin="anonymous"></audio>

        <div class="control-grid">
            <select id="songSelect" onchange="selectSong(this.value)">
                <option value="0">Snake Eater VenomSnake_Twitch Mix</option>
                <option value="1">Ghost Town by VenomSnake_Twitch</option>
                <option value="2">Wreckfest</option>
                <option value="3">In The Air Tonight(VenomSnake_Twitch)</option>
                <option value="4">Paradies City</option>
                <option value="5">Parasit√§res Bewustsein</option>
                <option value="6">Still Alive (Voiced)</option>
                <option value="7">Yu-Gi-Oh! Master Duel Solo Gate Theme Synth Mix</option>
                <option value="8">Bye Bye Beautiful</option>
                <option value="9">Kettenreaktion (Cover)</option>
                <option value="10">Strasse der Verdammnis</option>
                <option value="11">Syphon Filter Synth Mix</option>
                <option value="12">VenomSnake Mode Intro song</option>
                <option value="13">Hell March [Retaliation Cover]</option>
                <option value="14">Dance hall Dance(Cover)</option>
                <option value="15">Resident Evil 5 Desperate Escape Main Theme Music(Remix)</option>
                <option value="16">Bleed out My Friend</option>
                <option value="17">Revenge</option>
                <option value="18">Revenge 2</option>
                <option value="19">Survival Of Death</option>
                <option value="20">Pile of Total Wreck</option>
                <option value="21">Desert Storm Ahead</option>
                <option value="22">Industrial Breakdown</option>
                <option value="23">Mental Breakdown</option>
                <option value="24">Metal Gear 2 Solid Snake Chasing the Green Beret Remix</option>
                <option value="25">Metal Gear 2 Solid Snake Frequency 140.85 Remix Version 2026</option>
                <option value="26">Metal Gear 2 Solid Snake Level1 Warning Remix</option>
                <option value="27">Metal Gear 2 Solid Snake Level3 Warning Remix</option>
                <option value="28">Metal Gear 2 Solid Snake Reprieve of The Doctor Remix</option>
                <option value="29">Operation Stealth Destruction</option>
                <option value="30">Takin' On The Shagohod Remake</option>
                <option value="31">Metal Gear 2 Solid Snake Frequency 140.85</option>
            </select>
            <button onclick="openVisualizer()">[ VISUALIZER ]</button>
            <a id="downloadBtn" href="#" download class="download-btn">DOWNLOAD</a>
        </div>

        <div class="slider-row">
            <span class="slider-label" id="timeLabel">0:00</span>
            <input type="range" id="progress" min="0" max="100" value="0">
            <span class="slider-label" id="durationLabel">0:00</span>
        </div>

        <div class="slider-row">
            <span class="slider-label">VOL</span>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.5">
            <span class="slider-label" id="volumeLabel">50%</span>
        </div>

        <div class="control-grid">
            <button id="radioModeBtn" onclick="toggleRadioMode()">üìª RADIO: AUS</button>
            <button id="loopModeBtn" onclick="toggleLoopMode()">üîÇ LOOP: AUS</button>
            <button onclick="prevSong()">‚èÆ ZUR√úCK</button>
            <button id="playPauseBtn" onclick="togglePlay()">‚ñ∂ PLAY</button>
            <button onclick="nextSong()">WEITER ‚è≠</button>
        </div>

        <div id="infoBox">
            <div class="infoColumn">
                <h3>Neue Songs Sind Da!</h3>
                <p>Metal Gear 2 Solid Snake Chasing the Green Beret Remix</p>
                <p>Metal Gear 2 Solid Snake Freqency 140.85 Remix Version 2026</p>
                <p>Metal Gear 2 Solid Snake Level1 Warning Remix</p>
                <p>Metal Gear 2 Solid Snake Level3 Warning Remix</p>
                <p>Metal Gear 2 Solid Snake Reprieve of The Doctor Remix</p>
                <p>Takin' On The Shagohod Remake</p>
                <p>Metal Gear 2 Solid Snake Frequency 140.85</p>
            </div>
            <div class="infoColumn">
                <h3>Bald Erscheinende Songs</h3>
                <p>Weitere Projekte in Planung...</p>
            </div>
        </div>
    </div>
</main>

<div id="visualizerOverlay">
    <div style="color:var(--mgs-green); margin-bottom:10px; font-family:'Chakra Petch';">VENOM_VISUALIZER_V5.0</div>
    
    <canvas id="visualizerCanvas"></canvas>

    <div class="vis-player-ui">
        <div class="slider-row" style="margin:0; background:none; border:none;">
            <span class="slider-label" id="visTimeLabel">0:00</span>
            <input type="range" id="visProgress" min="0" max="100" value="0" oninput="seekAudio(this.value)">
            <span class="slider-label" id="visDurationLabel">0:00</span>
        </div>

        <div class="vis-row">
            <select id="visSongSelect" onchange="selectSong(this.value)" style="flex-grow:1;"></select>
        </div>

        <div class="vis-row">
            <button onclick="prevSong()">‚èÆ</button>
            <button id="visPlayPauseBtn" onclick="togglePlay()" style="min-width:100px;">‚ñ∂ PLAY</button>
            <button onclick="nextSong()">‚è≠</button>
            <button id="visRadioBtn" onclick="toggleRadioMode()">üìª</button>
            <button id="visLoopBtn" onclick="toggleLoopMode()">üîÇ</button>
            <button onclick="setVisMode('ring')">RING</button>
            <button onclick="setVisMode('bars')">BARS</button>
            <select onchange="handleBackgroundOption(this.value); this.value='';" style="width:auto;">
                <option value="">BG</option>
                <option value="change">EDIT</option>
                <option value="reset">X</option>
            </select>
            <button onclick="closeVisualizer()" style="color:#ff4141; border-color:#ff4141;">EXIT</button>
        </div>
    </div>
    <input type="file" id="bgFileInput" accept="image/*" style="display:none;">
</div>

<footer>
    <p>EST. 2026 // FREQUENCY: 140.85 MHz // OPERATOR: VENOMSNAKE_TWITCH</p>
</footer>

<script>
const songs = [
  "Snake Eater VenomSnake_Twitch Mix.mp3", "Ghost Town by VenomSnake_Twitch.mp3", "Wreckfest.mp3",
  "In The Air Tonight(VenomSnake_Twitch).mp3", "Paradies City.mp3", "Parasit√§res Bewustsein.mp3",
  "Still Alive (Voiced).mp3", "Yu-Gi-Oh! Master Duel Solo Gate Theme Synth Mix.mp3", "ByeByeBeautiful.mp3",
  "Kettenreaktion (Cover).mp3", "Strasse der Verdammnis.mp3", "Syphon Filter Synth Mix.mp3",
  "VenomSnake Mode Intro song.mp3", "Hell March [Retaliation Cover].mp3", "Dance hall Dance(Cover).mp3",
  "Resident Evil 5 Desperate Escape Main Theme Music(Remix).mp3", "Bleed out My Frend.mp3",
  "Revange.mp3", "Revange 2.mp3", "Survival Of Death.mp3", "Pile of Total Wreck.mp3",
  "Dessert Storm Ahead.mp3", "Industrial Breakdown.mp3", "Mental Breakdown.mp3",
  "Metal Gear 2 Solid Snake Chasing the Green Beret Remix.mp3", "Metal Gear 2 Solid Snake Freqency 140.85 Remix Version 2026.mp3",
  "Metal Gear 2 Solid Snake Level1 Warning Remix.mp3", "Metal Gear 2 Solid Snake Level3 Warning Remix.mp3",
  "Metal Gear 2 Solid Snake Reprieve of The Doctor Remix.mp3", "Operation Stealth Destruction.mp3",
  "Takin' On The Shagohod Remake.mp3", "Metal Gear 2 Solid Snake Freqency 140.85.mp3"
];

const BASE_URL = "https://raw.githubusercontent.com/VenomSnakeTwitch/VenomSnake_Twitch-Webseite/main/";
let currentIndex = 0;
let audioCtx, analyser, dataArray, animationId;
let visMode = 'ring';
let customCanvasBg = null;
let isRadioMode = false;
let isLoopMode = false;

const audio = document.getElementById("audioPlayer");
const logoImg = new Image();
logoImg.src = "https://raw.githubusercontent.com/VenomSnakeTwitch/VenomSnake_Twitch-Webseite/main/DogVenomsnakeLogo.png";

const bgInput = document.getElementById('bgFileInput');

window.addEventListener('DOMContentLoaded', () => {
    const mainSelect = document.getElementById("songSelect");
    const visSelect = document.getElementById("visSongSelect");
    visSelect.innerHTML = mainSelect.innerHTML;
});

function handleBackgroundOption(val) {
    if(val === 'change') bgInput.click();
    if(val === 'reset') {
        localStorage.removeItem('codec_canvas_bg');
        customCanvasBg = null;
    }
}

bgInput.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
            const imgData = event.target.result;
            localStorage.setItem('codec_canvas_bg', imgData);
            loadCanvasBackground(imgData);
        };
        reader.readAsDataURL(file);
    }
});

function loadCanvasBackground(data) {
    const img = new Image();
    img.onload = () => { customCanvasBg = img; };
    img.src = data;
}

if(localStorage.getItem('codec_canvas_bg')) {
    loadCanvasBackground(localStorage.getItem('codec_canvas_bg'));
}

function loadSong(index) {
    currentIndex = parseInt(index);
    audio.src = BASE_URL + encodeURIComponent(songs[currentIndex]);
    document.getElementById("songSelect").value = currentIndex;
    document.getElementById("visSongSelect").value = currentIndex;
    document.getElementById("downloadBtn").href = audio.src;
    const songTitle = document.getElementById("songSelect").options[currentIndex].text.toUpperCase();
    document.getElementById("currentSong").textContent = "‚ñ∂ " + songTitle;
}

function togglePlay() {
    if(!audioCtx) initAudioSystem();
    if (audio.paused) { 
        audio.play(); 
        updatePlayButtons("‚è∏ PAUSE");
    } else { 
        audio.pause(); 
        updatePlayButtons("‚ñ∂ PLAY");
    }
}

function updatePlayButtons(text) {
    document.getElementById("playPauseBtn").textContent = text;
    document.getElementById("visPlayPauseBtn").textContent = text;
}

audio.onended = () => {
    if (isLoopMode) {
        audio.currentTime = 0;
        audio.play();
    } else if (isRadioMode) {
        let randomIndex;
        do {
            randomIndex = Math.floor(Math.random() * songs.length);
        } while (randomIndex === currentIndex && songs.length > 1);
        selectSong(randomIndex);
    } else {
        nextSong();
    }
};

function toggleRadioMode() {
    isRadioMode = !isRadioMode;
    if (isRadioMode) isLoopMode = false;
    updateModeUI();
}

function toggleLoopMode() {
    isLoopMode = !isLoopMode;
    if (isLoopMode) isRadioMode = false;
    updateModeUI();
}

function updateModeUI() {
    const radioBtn = document.getElementById("radioModeBtn");
    const loopBtn = document.getElementById("loopModeBtn");
    const visRadioBtn = document.getElementById("visRadioBtn");
    const visLoopBtn = document.getElementById("visLoopBtn");

    radioBtn.textContent = isRadioMode ? "üìª RADIO: AN" : "üìª RADIO: AUS";
    loopBtn.textContent = isLoopMode ? "üîÇ LOOP: AN" : "üîÇ LOOP: AUS";
    
    radioBtn.classList.toggle("active-mode", isRadioMode);
    loopBtn.classList.toggle("active-mode", isLoopMode);
    visRadioBtn.classList.toggle("active-mode", isRadioMode);
    visLoopBtn.classList.toggle("active-mode", isLoopMode);
}

function initAudioSystem() {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    analyser = audioCtx.createAnalyser();
    const source = audioCtx.createMediaElementSource(audio);
    source.connect(analyser);
    analyser.connect(audioCtx.destination);
    analyser.fftSize = 256;
    dataArray = new Uint8Array(analyser.frequencyBinCount);
}

function setVisMode(mode) { visMode = mode; }

function draw() {
    animationId = requestAnimationFrame(draw);
    analyser.getByteFrequencyData(dataArray);
    const canvas = document.getElementById("visualizerCanvas");
    const ctx = canvas.getContext("2d");
    
    ctx.clearRect(0, 0, canvas.width, canvas.height); 

    if (customCanvasBg) {
        let hRatio = canvas.width / customCanvasBg.width;
        let vRatio = canvas.height / customCanvasBg.height;
        let ratio  = Math.max(hRatio, vRatio);
        let centerShiftX = (canvas.width - customCanvasBg.width * ratio) / 2;
        let centerShiftY = (canvas.height - customCanvasBg.height * ratio) / 2;
        
        ctx.globalAlpha = 0.7; 
        ctx.drawImage(customCanvasBg, 0, 0, customCanvasBg.width, customCanvasBg.height,
                      centerShiftX, centerShiftY, customCanvasBg.width * ratio, customCanvasBg.height * ratio);
        ctx.globalAlpha = 1.0;
    }

    if (visMode === 'ring') {
        drawRing(ctx, canvas);
    } else {
        drawBars(ctx, canvas);
    }
}

function drawRing(ctx, canvas) {
    ctx.save();
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const bufferLength = dataArray.length;
    const logoBase = Math.min(canvas.width, canvas.height) * 0.32;
    
    let sum = 0;
    for(let i = 0; i < bufferLength; i++) sum += dataArray[i];
    let avgAmp = sum / bufferLength;
    let pulse = avgAmp * 0.4;
    
    const logoSize = logoBase + pulse;

    if (logoImg.complete) {
        ctx.shadowBlur = 20 + pulse;
        ctx.shadowColor = 'rgba(0, 255, 65, 0.5)';
        ctx.drawImage(logoImg, centerX - logoSize/2, centerY - logoSize/2, logoSize, logoSize);
    }

    const ringRadius = (logoBase * 0.6) + (pulse * 0.2);
    ctx.beginPath();
    ctx.arc(centerX, centerY, ringRadius, 0, Math.PI * 2);
    ctx.lineWidth = 4;
    ctx.strokeStyle = `rgba(0, 255, 65, 0.4)`;
    ctx.stroke();

    const rayCount = 80;
    for (let i = 0; i < rayCount; i++) {
        const angle = (i / rayCount) * Math.PI * 2;
        const mirroredIndex = Math.floor(Math.abs((i % (rayCount / 2)) - (rayCount / 4)) * (bufferLength / (rayCount / 4)));
        const amp = dataArray[mirroredIndex] / 255;
        const rayLength = amp * (ringRadius * 0.8);

        ctx.strokeStyle = `rgba(0, 255, 65, ${0.7 + amp * 0.3})`;
        ctx.lineWidth = 2 + amp * 5;
        ctx.beginPath();
        ctx.moveTo(centerX + Math.cos(angle) * ringRadius, centerY + Math.sin(angle) * ringRadius);
        ctx.lineTo(centerX + Math.cos(angle) * (ringRadius + rayLength), centerY + Math.sin(angle) * (ringRadius + rayLength));
        ctx.stroke();
    }
    ctx.restore();
}

function drawBars(ctx, canvas) {
    const barWidth = (canvas.width / dataArray.length) * 2.5;
    let x = 0;
    for (let i = 0; i < dataArray.length; i++) {
        let barHeight = dataArray[i] * 1.5;
        ctx.fillStyle = "#00ff41";
        ctx.fillRect(x, canvas.height - barHeight, barWidth - 1, barHeight);
        x += barWidth;
    }
}

function openVisualizer() { 
    if(!audioCtx) initAudioSystem();
    document.getElementById("visualizerOverlay").classList.add("active");
    const canvas = document.getElementById("visualizerCanvas");
    canvas.width = window.innerWidth * 0.9;
    canvas.height = window.innerHeight * 0.6;
    draw();
}

function closeVisualizer() { 
    document.getElementById("visualizerOverlay").classList.remove("active");
    cancelAnimationFrame(animationId);
}

function toggleFullscreen() {
    if (!document.fullscreenElement) document.documentElement.requestFullscreen();
    else document.exitFullscreen();
}

function selectSong(val) { loadSong(val); audio.play(); updatePlayButtons("‚è∏ PAUSE"); }
function nextSong() { let next = (currentIndex + 1) % songs.length; loadSong(next); audio.play(); updatePlayButtons("‚è∏ PAUSE"); }
function prevSong() { let prev = (currentIndex - 1 + songs.length) % songs.length; loadSong(prev); audio.play(); updatePlayButtons("‚è∏ PAUSE"); }
function seekAudio(val) { audio.currentTime = (val / 100) * audio.duration; }

audio.ontimeupdate = () => {
    if(!isNaN(audio.duration)) {
        const prog = (audio.currentTime / audio.duration) * 100;
        document.getElementById("progress").value = prog;
        document.getElementById("timeLabel").textContent = formatTime(audio.currentTime);
        document.getElementById("durationLabel").textContent = formatTime(audio.duration);
        document.getElementById("visProgress").value = prog;
        document.getElementById("visTimeLabel").textContent = formatTime(audio.currentTime);
        document.getElementById("visDurationLabel").textContent = formatTime(audio.duration);
    }
};

document.getElementById("volumeSlider").oninput = function() {
    audio.volume = this.value;
    document.getElementById("volumeLabel").textContent = Math.round(this.value * 100) + "%";
};

document.getElementById("progress").oninput = function() { seekAudio(this.value); };

function formatTime(s) { let m = Math.floor(s/60), sec = Math.floor(s%60).toString().padStart(2, '0'); return m + ":" + sec; }
window.onload = () => { loadSong(0); audio.volume = 0.5; };

// Registrierung des Service Workers
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
            .then(reg => console.log('Service Worker registriert: ', reg.scope))
            .catch(err => console.log('Service Worker Registrierung fehlgeschlagen: ', err));
    });
}
</script>
</body>
</html>
